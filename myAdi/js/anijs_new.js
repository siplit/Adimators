!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("AniJS requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){var n=function(t){t={rootDOMTravelScope:{},eventProviderCollection:{},init:function(){n._helperCollection={};var e=n._createDefaultHelper();t.registerHelper("default",e),n._helperDefaultIndex="default",t.rootDOMTravelScope=document,t.Parser=n.Parser,n._animationEndEvent=n._animationEndPrefix(),n._classNamesWhenAnim=""},setDOMRootTravelScope:function(e){var n;try{"document"===e?n=document:(n=document.querySelector(e))||(n=document)}catch(e){n=document}t.rootDOMTravelScope=n},run:function(){var e,r={};t.purgeAll(),t.eventProviderCollection={};for(var i,o=(e=n._findAniJSNodeCollection(t.rootDOMTravelScope)).length,a=0;a<o;a++)i=e[a],r=n._getParsedAniJSSentenceCollection(i.getAttribute("data-anijs")),n._setupElementAnim(i,r)},createAnimation:function(e,t){var r=t||"";n._setupElementAnim(r,e)},getHelper:function(e){var t=n._helperCollection;return t[e]||t.default},registerHelper:function(e,t){n._helperCollection[e]=t},purge:function(e){if(e&&""!==e&&" "!==e)for(var n=document.querySelectorAll(e),r=n.length,i=0;i<r;i++)t.EventSystem.purgeEventTarget(n[i])},purgeAll:function(){t.EventSystem.purgeAll()},purgeEventTarget:function(e){t.EventSystem.purgeEventTarget(e)},setClassNamesWhenAnim:function(e){n._classNamesWhenAnim=" "+e},createEventProvider:function(){return t.EventSystem.createEventTarget()},registerEventProvider:function(e){var n=t.eventProviderCollection;return e.id&&e.value&&t.EventSystem.isEventTarget(e.value)?(n[e.id]=e.value,1):""},getEventProvider:function(e){return t.eventProviderCollection[e]}};var n={_createDefaultHelper:function(){return{removeAnim:function(e,t){t.nodeHelper.removeClass(e.target,t.behavior)},holdAnimClass:function(e,t){}}},_createParser:function(){return new Parser},_setupElementAnim:function(e,t){for(var r,i=t.length,o=0;o<i;o++)r=t[o],n._setupElementSentenceAnim(e,r)},_setupElementSentenceAnim:function(e,r){var i=n._eventHelper(r),o=n._eventTargetHelper(e,r);if(""!==i){for(var a,l=o.length,s=0;s<l;s++)if(a=o[s],t.EventSystem.isEventTarget(a)){var v=function(i){var o=n._behaviorTargetHelper(e,r),a=n._behaviorHelper(r),l=n._beforeHelper(e,r),s=n._afterHelper(e,r);""!==n._classNamesWhenAnim&&(a+=n._classNamesWhenAnim);var v={behaviorTargetList:o,nodeHelper:n.NodeHelper,animationEndEvent:n._animationEndEvent,behavior:a,after:s,eventSystem:t.EventSystem},c=new n.AnimationContext(v);l&&n.Util.isFunction(l)?l(i,c):c.run()};t.EventSystem.addEventListenerHelper(a,i,v,!1),t.EventSystem.registerEventHandle(a,i,v)}}else console.log("You must define some event")},_eventHelper:function(e){var t=e.event||"";return"animationend"===t?t=n._animationEndPrefix():"transitionend"===t&&(t=n._transitionEndPrefix()),t},_eventTargetHelper:function(r,i){var o,a=[r],l=t.rootDOMTravelScope;if(i.eventTarget)if((o=n._eventProviderHelper(i.eventTarget)).length>0)a=o;else if("document"===i.eventTarget)a=[document];else if("window"===i.eventTarget)a=[e];else if(i.eventTarget.split)try{a=l.querySelectorAll(i.eventTarget)}catch(e){console.log("Ugly Selector Here"),a=[]}return a},_behaviorTargetHelper:function(e,n){var r=[e],i=t.rootDOMTravelScope,o=n.behaviorTarget;if(o){o=o.split("$").join(",");try{r=i.querySelectorAll(o)}catch(e){r=[],console.log("ugly selector here")}}return r},_behaviorHelper:function(e){return e.behavior||""},_afterHelper:function(e,t){return n._callbackHelper(e,t,t.after)},_beforeHelper:function(e,t){return n._callbackHelper(e,t,t.before)},_callbackHelper:function(e,t,r){var i=r||"",o=n._helperHelper(t);if(i&&!n.Util.isFunction(i)){var a=n._helperCollection[o];i=!(!a||!a[i])&&a[i]}return i},_helperHelper:function(e){return e.helper||n._helperDefaultIndex},_eventProviderHelper:function(e){var n=[];t.eventProviderCollection;if(e)if(e.id&&t.EventSystem.isEventTarget(e.value))n.push(e.value),t.registerEventProvider(e);else if(e.split){eventProviderIDList=e.split("$");for(var r,i=eventProviderIDList.length,o=1;o<i;o++)if((r=eventProviderIDList[o])&&" "!==r){r=r.trim();var a=t.getEventProvider(r);a||(a=t.EventSystem.createEventTarget(),t.registerEventProvider({id:r,value:a})),n.push(a)}}return n},_getParsedAniJSSentenceCollection:function(e){return n.Parser.parse(e)},_findAniJSNodeCollection:function(e){return e.querySelectorAll("[data-anijs]")},_animationEndPrefix:function(){return["animationend","oAnimationEnd","animationend","webkitAnimationEnd"][n._endPrefixBrowserDetectionIndex()]},_transitionEndPrefix:function(){return["transitionend","oTransitionEnd","transitionend","webkitTransitionEnd"][n._endPrefixBrowserDetectionIndex()]},_endPrefixBrowserDetectionIndex:function(){for(var e=document.createElement("fakeelement"),t=["animation","OAnimation","MozAnimation","webkitAnimation"],n=0;n<t.length;n++)if(void 0!==e.style[t[n]])return n},AnimationContext:function(e){var t=this;t.init=function(e){t.behaviorTargetList=e.behaviorTargetList||[],t.nodeHelper=e.nodeHelper,t.animationEndEvent=e.animationEndEvent,t.behavior=e.behavior,t.after=e.after,t.eventSystem=e.eventSystem},t.run=function(){for(var e,r=t,i=r.behaviorTargetList,o=i.length,a=r.nodeHelper,l=r.behavior,s=r.animationEndEvent,v=r.after,c=0;c<o;c++)e=i[c],a.addClass(e,l),r.eventSystem.addEventListenerHelper(e,s,function(e){r.eventSystem.removeEventListenerHelper(e.target,e.type,arguments.callee),v?n.Util.isFunction(v)&&v(e,t):a.removeClass(e.target,l)})},t.init(e)},Parser:{parse:function(e){return this.parseDeclaration(e)},parseDeclaration:function(e){for(var t,n,r=[],i=(t=e.split(";")).length,o=0;o<i;o++)n=this.parseSentence(t[o]),r.push(n);return r},parseSentence:function(e){for(var t,n,r={},i=(t=e.split(",")).length,o=0;o<i;o++)r[(n=this.parseDefinition(t[o])).key]=n.value;return r},parseDefinition:function(e){var t,n,r,i={};return(t=e.split(":")).length>1&&(n=t[0].trim(),r=t[1].trim(),"if"===n?n="event":"on"===n?n="eventTarget":"do"===n?n="behavior":"to"===n&&(n="behaviorTarget"),i.key=n,i.value=r),i}}};return n.NodeHelper={addClass:function(e,t){t instanceof Array||(t=t.split(" "));for(var n=0,r=t.length;n<r;++n)t[n]&&!new RegExp("(\\s+|^)"+t[n]+"(\\s+|$)").test(e.className)&&(e.className=e.className.trim()+" "+t[n])},removeClass:function(e,t){t instanceof Array||(t=t.split(" "));for(var n=0,r=t.length;n<r;++n)e.className=e.className.replace(new RegExp("(\\s+|^)"+t[n]+"(\\s+|$)")," ").trim()},hasClass:function(e,t){return t&&new RegExp("(\\s+|^)"+t+"(\\s+|$)").test(e.className)}},n.Util={isFunction:function(e){return!!(e&&e.constructor&&e.call&&e.apply)}},t.EventSystem={eventCollection:{},eventIdCounter:0,isEventTarget:function(e){return e.addEventListener?1:0},createEventTarget:function(){return new t.EventTarget},addEventListenerHelper:function(e,t,n,r){e.addEventListener(t,n,!1)},removeEventListenerHelper:function(e,t,n){e.removeEventListener(t,n)},purgeAll:function(){for(var e,t,n=this.eventCollection,r=Object.keys(n),i=r.length,o=0;o<i;o++)(t=n[e=r[o]])&&t.handleCollection&&t.handleCollection.length>0&&this.purgeEventTarget(t.handleCollection[0].element),delete n[e]},purgeEventTarget:function(e){var t,n=e._aniJSEventID;if(n){for(var r,i=(t=this.eventCollection[n].handleCollection).length,o=0;o<i;o++)r=t[o],this.removeEventListenerHelper(e,r.eventType,r.listener);this.eventCollection[n]=e._aniJSEventID=null,delete this.eventCollection[n],delete e._aniJSEventID}},registerEventHandle:function(e,t,n){var r=e._aniJSEventID,i=this.eventCollection,o={eventType:t,listener:n,element:e};if(r)i[r].handleCollection.push(o);else{var a={handleCollection:[o]};i[++this.eventIdCounter]=a,e._aniJSEventID=this.eventIdCounter}}},t.EventTarget=function(){this._listeners={}},t.EventTarget.prototype={constructor:t.EventTarget,addEventListener:function(e,t,n){void 0===this._listeners[e]&&(this._listeners[e]=[]),this._listeners[e].push(t)},dispatchEvent:function(e){if("string"==typeof e&&(e={type:e}),e.target||(e.target=this),!e.type)throw new Error("Event object missing 'type' property.");if(this._listeners[e.type]instanceof Array)for(var t=this._listeners[e.type],n=0,r=t.length;n<r;n++)t[n].call(this,e)},removeEventListener:function(e,t){if(this._listeners[e]instanceof Array)for(var n=this._listeners[e],r=0,i=n.length;r<i;r++)if(n[r]===t){n.splice(r,1);break}}},t}(n||{});return n.init(),n.run(),"function"==typeof define&&define.amd&&define("anijs",[],function(){return n}),void 0===t&&(e.AniJS=n),n});